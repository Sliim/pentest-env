# -*- mode: yaml -*-

targets:
  - chef-server:
      base: ubuntu-14.04
  - chef-workstation:
      base: debian-9.0
  - cs-dvwa:
      base: ubuntu-14.04
  - cs-webgoat:
      base: ubuntu-14.04
  - cs-gruyere:
      base: ubuntu-14.04
  - cs-vicnum:
      base: ubuntu-14.04
  - cs-bricks:
      base: ubuntu-14.04

chef-server:
  networks:
    - private_network:
        adapter: 2
        ip: 172.28.128.222
  chef:
    version: 12.17.44
    recipes:
      - hostname
      - chef-server
      - pentest-env::chef_server_org
    json:
      set_fqdn: chef-server.pentest.env
      chef-server:
        api_fqdn: chef-server.pentest.env
      pentest-env:
        chef_server_ip: 172.28.128.222
        chef_server_host: chef-server.pentest.env

chef-workstation:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  chef:
    version: 12.17.44
    recipes:
      - hostname
      - pentest-env::chef_workstation_init
      - pentest-env::chef_workstation_wargame_init
    json:
      set_fqdn: chef-workstation.pentest.env
      pentest-env:
        chef_server_ip: 172.28.128.222
        chef_server_host: chef-server.pentest.env
  chef_client:
    node_name: workstation
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true

cs-dvwa:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  commands:
    - grep chef-server.pentest.env /etc/hosts || echo 172.28.128.222  chef-server.pentest.env >> /etc/hosts
  chef_client:
    node_name: dvwa
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true

cs-webgoat:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  commands:
    - grep chef-server.pentest.env /etc/hosts || echo 172.28.128.222  chef-server.pentest.env >> /etc/hosts
  chef_client:
    node_name: webgoat
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true

cs-gruyere:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  commands:
    - grep chef-server.pentest.env /etc/hosts || echo 172.28.128.222  chef-server.pentest.env >> /etc/hosts
  chef_client:
    node_name: gruyere
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true

cs-vicnum:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  commands:
    - grep chef-server.pentest.env /etc/hosts || echo 172.28.128.222  chef-server.pentest.env >> /etc/hosts
  chef_client:
    node_name: vicnum
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true

cs-bricks:
  networks:
    - private_network:
        adapter: 2
        type: dhcp
        ip: 172.28.128.0/24
  commands:
    - grep chef-server.pentest.env /etc/hosts || echo 172.28.128.222  chef-server.pentest.env >> /etc/hosts
  chef_client:
    node_name: bricks
    version: 12.17.44
    environment: wargames
    chef_server_url: https://chef-server.pentest.env/organizations/pentest-env
    validation_key_path: data/pentest-env-validator.pem
    validation_client_name: pentest-env-validator
    delete_client: true
